<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AHHFAKJUICE Ecommerce Website</title>
    <script src="https://app.midtrans.com/snap/snap.js" data-client-key="Mid-client-KckTftbWyhgcuYCv"></script>
    <link rel="stylesheet" href="css/cart.css">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://unpkg.com/swiper@8/swiper-bundle.min.css" />
    <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />
</head>

<body>
    <div id="page" class="site page-single">

    <aside class="site-off desktop-hide">
        <div class="off-canvas">
            <div class="canvas-head flexitem">
                <div class="logo">
                    <a href="/">
                        <img src="assets/logo/AHHFAK ELIQUID FACTORY-12.png" class="custom-logo-big" alt="AHHFAK Logo" />
                    </a>
                    </div>
                <a href="#" class="t-close flexcenter"><i class=" ri-close-line"></i></a>
            </div>
            <div class="departments"></div>
            <nav></nav>
            <div class="thetop-nav"></div>
        </div>
    </aside>

    <header>
    <div class="header-top mobile-hide">
            <div class="container">
                <div class="wrapper flexitem">
                    <div class="left">
                        <ul class="flexitem main-links">
                            <li><a href="#"></a></li>
                            <li><a href="#"></a></li>
                        </ul>
                    </div>
                    <div class="right">
                        <ul class="flexitem main-links">
                            <li><a href="#"></a></li>
                                <ul>
                                    <li class="current"><a href="#"></a></li>
                                    <li class="current"><a href="#"></a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    <!-- header-top -->
    <div class="header-nav">
    <div class="container">
        <div class="wrapper flexitem">
            <a href="#" class="trigger desktop-hide"><span class="i ri-menu-2-line"></span></a>
            <div class="left flexitem">
                <div class="logo">
                    <a href="index.html">
                        <img src="assets/logo/Logo - edit - black-03.png" alt="" />
                        <!-- <img src="public/assets/logo/LOGO FAITH hitam-03.png"  alt="" /> -->
                        </a>
                    </div>
                <nav class="mobile-hide">
                    <ul class="flexitem second-links">
                        <li><a href="index.html" class="active">Home</a></li>
                        <li><a href="view all brands.html">Semua Produk</a></li>
                        <li class="has-child">
                            <a href="#">Kategori Produk
                                <div class="icon-small"><i class="ri-arrow-down-s-line"></i></div>
                            </a>
                        <div class="mega">
                        <div class="container">
                            <div class="wrapper">
                                <div class="flexcol">
                                    <div class="row">
                                        <h4>Fruity Madness</h4>
                                        <ul>
                                            <li><a href="page-single-mango.html">Sweet Mango</a></li>
                                            <li><a href="page-single-lychee.html">Push Pop Lychee</a></li>
                                            <li><a href="page-single-grape.html">Grape Delight</a></li>
                                            <li><a href="page-single-melon.html">Mighty Melon</a></li>
                                            <li><a href="page-single-lemon.html">Lemon Splash</a></li>
                                            <li><a href="page-single-straw.html">Happy Strawberry</a></li>
                                            <li><a href="page-single-guava.html">Guava Bliss</a></li>
                                            <li><a href="page-single-apple.html">Lush Apple</a></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="flexcol">
                                    <div class="row">
                                        <h4>Faith Series</h4>
                                        <ul>
                                            <li><a href="page-single-faith-straw.html">Strawberry Jam</a></li>
                                            <li><a href="page-single-faith-banana.html">Banana Peanut Buuter</a></li>
                                            <li><a href="page-single-faith-vanilla.html">Vanilla Tobacco</a></li>
                                            <li><a href="page-single-faith-whisky.html">Scotch Whisky</a></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="flexcol">
                                    <div class="row">
                                        <h4>CHZ & SMITH Series</h4>
                                        <ul>
                                            <li><a href="page-single-chz-straw.html">Strawbery Cheesecake</a></li>
                                            <li><a href="page-single-chz-straw.html">Blueberry Cheesecake</a></li>
                                            <li><a href="page-single-smith-sundae.html">Sundae Ice Cream</a></li>
                                            <li><a href="page-single-smith-mango.html">Sour Mango</a></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="flexcol">
                                    <div class="row">
                                        <h4>Creamy Series</h4>
                                        <ul class="liquid-series">
                                            <li><a href="page-single-creamy-blk.html">Berry Laker Kreme</a></li>
                                            <li><a href="page-single-creamy-mac.html">Coffe Cream Machito</a></li>
                                            <li><a href="page-single-creamy-brax.html">Knusprig Biscuit</a></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="flexcol">
                                    <div class="row">
                                        <h4>Milky Madness</h4>
                                        <ul>
                                            <li><a href="#">Coming Soon</a></li>
                                            <li><a href="#">Coming Soon</a></li>
                                            <li><a href="#">Coming Soon</a></li>
                                            <li><a href="#">Coming Soon</a></li>
                                        </ul>
                                        <a href="view all brands.html" class="view-all">View all brands <i class="ri-arrow-right-line"></i></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </li>
                    <li><a href="milky-madness.html">Order Tracking</a></li>
                    <li><a href="https://wa.link/rm64ko">Contact Us</a></li>
                            </nav>
                        </div>
                        <div class="right">
                            <ul class="flexitem second-links">
                                <li class="mobile-hide"><a href="login.html">
                                    <div class="icon-large"><i class="fa-duotone fa-solid fa-user"></i></i></div>
                                </a>
                            </li>
                               <!-- Cart Icon -->
                                <li class="iscart">
                                <a href="#" onclick="openCart(event)">
                                    <div class="icon-large">
                                    <i class="ri-shopping-cart-2-fill"></i>
                                    <div class="fly-item">
                                        <span class="item-number" id="cartCount">0</span>
                                    </div>
                                    </div>
                                </a>
                                </li>

                                <!-- Cart Overlay -->
                                <div id="cartOverlay" class="cart-overlay">
                                <button onclick="closeCart()" class="close-btn">&times;</button>
                                <div class="cart-content">
                                    <h2>Keranjang</h2>

                                    <!-- Tempat isi produk -->
                                    <div id="cartList"></div>

                                    <!-- Total dan tombol -->
                                    <div class="cart-summary">
                                    <p><strong>Total:</strong> <span id="cartOverlayTotal">Rp 0</span></p>
                                    <a href="cart.html" class="btn-checkout">Lanjut ke Checkout</a>
                                    </div>
                                </div>
                                </div>

                            <div class="mini-cart">
                                <div class="content">
                                    <div class="cart-head">
                                        Belum ada product di keranjang
                                    </div>
                                    <div class="cart-body">
                                        <ul class="products mini">
                                            <li class="item">
                                            </li>
                                        </ul>
                                    </div>
                                        <div class="actions">
                                            <a href="cart.html" class="primary-button">Checkout</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>    
    </header>
        <!-- header main -->

        </header>
        <!-- header -->
        <main>

<!-- Checkout Section -->
<div class="single-checkout">
  <div class="container">
    <div class="wrapper">
      <div class="checkout flexwrap">

        <!-- Kiri: Form -->
        <div class="item left styled">
            <h1>Shipping Address</h1>
            <form id="checkout-form">
                <p>
                  <label for="email">Email <span>*</span></label><br>
                  <input type="email" name="email" id="email" autocomplete="email" required>
                </p>

                <p>
                  <label for="name">Full Name <span>*</span></label><br>
                  <input type="text" name="name" id="name" autocomplete="name" required>
                </p>

                <p>
                  <label for="address">Street Address <span>*</span></label><br>
                  <input type="text" name="address" id="address" autocomplete="street-address" required>
                </p>

                <p>
                  <label for="phone">Phone Number <span>*</span></label><br>
                  <input type="tel" name="phone" id="phone" pattern="08[0-9]{8,12}" autocomplete="tel" required>
                </p>
                <p>
                <label for="city">Kota Tujuan <span>*</span></label>
                  <select id="city" name="city" required>
                    <option value="">Pilih kota</option>
                    <option value="Jakarta">Jakarta</option>
                    <option value="Bandung">Bandung</option>
                    <option value="Surabaya">Surabaya </option>
                    <option value="Yogyakarta">Yogyakarta</option>
                    <option value="Semarang">Semarang</option>
                  </select>
                <p>
                <label for="postal">Post Code<span>*</span></label>
                <input type="text" name="postal" id="postal" pattern="[0-9]{4,6}" maxlength="6" required>
                </p>
            </form>
            </div>
        <!-- Kanan: Ringkasan Order -->
        <div class="item right">
          <!-- Produk dari localStorage -->
          <div id="cart-container" class="prodcts mini"></div>

          <!-- Judul Order Summary -->
          <h2 class="order-summary-title">Order Summary</h2>

            <!-- Coupon Section -->
            <div class="coupon-section">
            <div class="have-coupon">
                <label class="custom-checkbox-label">
                <span class="label-text">
                    Punya kupon?
                    <a href="javascript:void(0)" onclick="toggleCouponForm(this)">Klik di sini untuk terapkan kupon</a>
                </span>
                </label>

                <div id="coupon-form" class="coupon-form">
                <p>Jika Anda memiliki kode kupon, silakan terapkan di bawah.</p>
                <input type="text" id="coupon-code" placeholder="Kode kupon" />
                <button type="button" onclick="applyCoupon()">Terapkan kupon</button>
                <p id="coupon-message" class="coupon-message"></p>
                </div>
            </div>
            </div>
        <!-- PEMBAYARAN -->
                <div class="summary-order is_sticky">
                    <div class="summary-totals">
                    <ul>
                        <li>
                        <span class="label">Subtotal</span>
                        <span class="value" id="subtotal">Rp</span>
                        </li>
                        <li>
                        <span class="label">Discount</span>
                        <span class="value" id="discount">Rp</span>
                        </li>
                        <li>
                        <span class="label">Shipping</span>
                        <span class="value" id="shipping">Rp</span>
                        </li>
                        <li class="total">
                        <span class="label">Total</span>
                        <span class="value" id="cart-total">Rp</span>
                        </li>
                    </ul>
                    </div>
                    <div class="primary-checkout">
                    <button class="primary-button" onclick="checkout()">Bayar Sekarang</button>
                    </div>
                </div>
                </div>
            </div>
            </div>
        </div>
        </div>
        <!-- main -->
        <footer>
    <div class="newsletter">
        <div class="container">
            <div class="wrapper">
            <div class="box">
                <div class="content">
                <h3>Join Our Newsletter</h3>
                <p>Dapatkan pembaruan E-mail tentang toko terbaru kami dan <strong>penawaran khusus</strong></p>
                </div>
                <form action="https://formspree.io/f/yourFormID" method="POST">
                <input type="email" name="email" placeholder="Your email address" required>
                <button type="submit" class="submit">Sign Up</button>
                </form>
            </div>
            </div>
        </div>
        </div>

<!-- FOOTER SECTION -->
<footer class="site-footer">
  <div class="container">

    <!-- Footer Grid -->
    <div class="footer-grid">

      <!-- Tentang Kami -->
      <div class="footer-col">
        <h4>About Us</h4>
        <ul class="flexcol">
            <li><a href="#">News</a></li>
            <li><a href="page-blog.html">Company Profile</a></li>
        </ul>
    </div>
      <!-- Produk -->
      <div class="footer-col">
        <h4>Product Categories</h4>
        <ul class="flexcol">
          <li><a href="fruity-madness.html">Fruity Madness</a></li>
          <li><a href="faith-series.html">Faith Series</a></li>
          <li><a href="creamy.html">Creamy Series</a></li>
          <li><a href="30ml series.html">CHZ & SMITH Series</a></li>
          <li><a href="#">Milky Madness</a></li>
        </ul>
      </div>

      <!-- Bantuan -->
      <div class="footer-col">
        <h4>Help & Contact</h4>
        <ul class="flexcol">
            <li><a href="page-FAQ.html">FAQ</a></li>
            <li><a href="#">Your Orders</a></li>
            <li><a href="https://wa.link/rm64ko">Contact us</a></li>
        </ul>
      </div>

      <!-- Pembayaran -->
      <div class="footer-col">
        <h4>Payment Info</h4>
        <p>Silakan pilih metode pembayaran yang tersedia. Transaksi Anda dijamin aman dan diawasi oleh OJK.</p>
        <div class="payment-icons">
          <img src="assets/Payment/bca-bank-logo-png_seeklogo-232742.png" alt="BCA" />
          <img src="assets/Payment/bank-mandiri-logo-png_seeklogo-16290.png" alt="Mandiri" />
          <img src="assets/Payment/bank-bni-logo-png_seeklogo-355606.png" alt="BNI" />
          <img src="assets/Payment/bank-rakyat-indonesia-logo-png_seeklogo-474339.png" alt="BRI" />
          <img src="assets/Payment/gopay-logo-png_seeklogo-369813.png" alt="Gopay" />
          <img src="assets/Payment/ovo-e-wallet-logo-png_seeklogo-399952.png" alt="OVO" />
          <img src="assets/Payment/dana-e-wallet-app-logo-png_seeklogo-399948.png" alt="Dana" />
          <img src="assets/Payment/quick-response-code-indonesia-standard-qris-logo-png_seeklogo-391791.png" alt="QRIS" />
        </div>
      </div>

    </div>

    <!-- Footer Bottom -->
    <div class="footer-info">
                <div class="container">
                    <div class="wrapper">
                        <div class="flexcol">
                            <div class="logo">
                            </div>
                            <div class="socials">
                                <ul class="flexitem">
                                    <li><a href="https://wa.link/rm64ko"><i class="ri-whatsapp-line"></i></a></li>
                                    <li><a href="https://www.instagram.com/ahhfakjuice?igsh=N3lrOWNrZWRvaWtq"><i class="ri-instagram-line"></i></a></li>
                                    <li><a href="https://www.tiktok.com/@ahhfakjuice.idn?_t=ZS-8xSbbp8MYsx&_r=1"><i class="ri-tiktok-fill"></i></a></li>
                                </ul>
                            </div>
                        </div>
                        <p class="mini-text">Copyright 2025 © .AHHFAK E-LIQUID FACTORY. All right reserved.</p>
                    </div>
                </div>
            </div>
    </footer>
  <!-- footer -->

    </div>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fslightbox/3.3.1/index.js"></script>
    <script src="script.js"></script>

<script>
let couponDiscount = 0;
let shippingCost = 0;
let swiperInstance;

const shippingRates = {
  "Jakarta": 18000,
  "Bandung": 19000,
  "Surabaya": 10000,
  "Yogyakarta": 16000,
  "Semarang": 15000,
};

function formatRupiah(number) {
  return new Intl.NumberFormat("id-ID", {
    style: "currency",
    currency: "IDR",
    minimumFractionDigits: 0,
  }).format(isNaN(number) ? 0 : number);
}

function getCartItems() {
  return JSON.parse(localStorage.getItem("cartItems") || "[]");
}

function loadCart() {
  const container = document.getElementById("cart-container");
  const totalEl = document.getElementById("cart-total");
  const subtotalEl = document.getElementById("subtotal");
  const discountEl = document.getElementById("discount");
  const shippingEl = document.getElementById("shipping");
  const msgEl = document.getElementById("coupon-message");

  let items = getCartItems();
  container.innerHTML = "";
  let subtotal = 0;

  if (!items.length) {
    container.innerHTML = '<p class="empty">Keranjang masih kosong.</p>';
    subtotalEl.textContent = totalEl.textContent = formatRupiah(0);
    discountEl.textContent = shippingEl.textContent = "-";
    msgEl.textContent = "";
    updateCartInfo();
    return;
  }

  items.forEach((item, index) => {
    const quantity = Math.max(1, Number(item.quantity) || 1);
    const price = Math.max(0, Number(item.price) || 0);
    const itemTotal = price * quantity;
    subtotal += itemTotal;

    const div = document.createElement("div");
    div.className = "cart-item";
    div.innerHTML = `
      <img src="${item.img || 'https://via.placeholder.com/60'}" alt="${item.name}">
      <div class="cart-details">
        <div class="cart-name">${item.name}</div>
        <div class="cart-qty">
          <button onclick="updateQty(${index}, -1)">-</button>
          <span>${quantity}</span>
          <button onclick="updateQty(${index}, 1)">+</button>
        </div>
      </div>
      <div class="cart-price">${formatRupiah(itemTotal)}</div>
      <button class="remove-btn" onclick="removeFromCart(${index})"><i class="ri-close-line"></i></button>
    `;
    container.appendChild(div);
  });

  const discountAmount = (subtotal * couponDiscount) / 100;
  const finalTotal = subtotal - discountAmount + shippingCost;

  subtotalEl.textContent = formatRupiah(subtotal);
  discountEl.textContent = couponDiscount > 0 ? `Rp -${discountAmount.toLocaleString("id-ID")}` : "-";
  totalEl.textContent = formatRupiah(finalTotal);
  shippingEl.textContent = shippingCost > 0 ? formatRupiah(shippingCost) : "-";

  msgEl.textContent = couponDiscount > 0
    ? `Diskon kupon ${couponDiscount}% diterapkan. Hemat ${formatRupiah(discountAmount)}.`
    : "";
  msgEl.style.color = couponDiscount > 0 ? "green" : "red";

  updateCartInfo();
  renderCartOverlay();
}

function updateQty(index, delta) {
  const items = getCartItems();
  if (!items[index]) return;
  items[index].quantity = Math.max(1, items[index].quantity + delta);
  localStorage.setItem("cartItems", JSON.stringify(items));
  loadCart();
}

function removeFromCart(index) {
  const items = getCartItems();
  items.splice(index, 1);
  localStorage.setItem("cartItems", JSON.stringify(items));
  loadCart();
}

function updateCartInfo() {
  const items = getCartItems();
  const count = items.reduce((sum, item) => sum + (item.quantity || 0), 0);
  const total = items.reduce((sum, item) => sum + (item.quantity * item.price), 0);

  const countEl = document.getElementById("cartCount");
  const totalEl = document.getElementById("cartTotal");

  if (countEl) countEl.textContent = count;
  if (totalEl) totalEl.textContent = formatRupiah(total);
}

function renderCartOverlay() {
  const items = getCartItems();
  const list = document.getElementById("cartList");
  const totalEl = document.getElementById("cartOverlayTotal");

  if (!list || !totalEl) return;
  if (!items.length) {
    list.innerHTML = '<p style="text-align:center;">Keranjang masih kosong.</p>';
    totalEl.textContent = formatRupiah(0);
    return;
  }

  list.innerHTML = "";
  let total = 0;

  items.forEach((item, index) => {
    const subtotal = item.quantity * item.price;
    total += subtotal;

    const div = document.createElement("div");
    div.className = "cart-item";
    div.innerHTML = `
      <img src="${item.img || 'https://via.placeholder.com/60'}" alt="${item.name}">
      <div class="cart-details">
        <div class="cart-name">${item.name}</div>
        <div class="cart-actions">
          <button onclick="updateQty(${index}, -1)">−</button>
          <span>${item.quantity}</span>
          <button onclick="updateQty(${index}, 1)">+</button>
          <span class="cart-price">${formatRupiah(item.price)}</span>
          <button class="remove-btn" onclick="removeFromCart(${index})"><i class="ri-close-line"></i></button>
        </div>
      </div>
    `;
    list.appendChild(div);
  });

  totalEl.textContent = formatRupiah(total);
}

function toggleCouponForm(el) {
  const form = document.getElementById("coupon-form");
  const icon = el?.querySelector(".custom-checkbox");
  if (!form) return;
  form.classList.toggle("visible");
  icon?.classList.toggle("active");
}

function applyCoupon() {
  const codeInput = document.getElementById("coupon-code");
  const msgEl = document.getElementById("coupon-message");
  const code = codeInput?.value.trim().toUpperCase();
  const coupons = { "DISKON10": 10, "HEMAT20": 20, "PROMO30": 30 };

  if (!code) {
    msgEl.textContent = "Silakan masukkan kode kupon.";
    msgEl.style.color = "red";
    return;
  }

  if (coupons[code]) {
    couponDiscount = coupons[code];
    msgEl.textContent = `Kupon "${code}" berhasil diterapkan! Diskon ${couponDiscount}%`;
    msgEl.style.color = "green";
    localStorage.setItem("appliedCoupon", code);
    document.getElementById("coupon-form")?.classList.remove("visible");
    document.querySelector(".custom-checkbox")?.classList.remove("active");
  } else {
    couponDiscount = 0;
    msgEl.textContent = `Kode kupon "${code}" tidak valid.`;
    msgEl.style.color = "red";
    localStorage.removeItem("appliedCoupon");
  }

  loadCart();
}

function updateShippingByCity() {
  const city = document.getElementById("city")?.value;
  shippingCost = shippingRates[city] || 0;
  loadCart();
}

async function checkout() {
  const name = document.getElementById("name")?.value.trim();
  const email = document.getElementById("email")?.value.trim();
  const phone = document.getElementById("phone")?.value.trim();
  const address = document.getElementById("address")?.value.trim();
  const items = getCartItems();

  if (!name) return alert("Mohon isi nama lengkap.");
  if (!email || !email.includes("@")) return alert("Email tidak valid.");
  if (!/^08[0-9]{8,12}$/.test(phone)) return alert("Nomor HP tidak valid.");
  if (!address) return alert("Mohon isi alamat lengkap.");
  if (!items.length) return alert("Keranjang masih kosong.");

  let subtotal = 0;
  const itemList = items.map(item => {
    const price = parseInt(item.price);
    const quantity = parseInt(item.quantity);
    subtotal += price * quantity;
    return {
      name: item.name,
      price: price,
      quantity: quantity
    };
  });

  const discountAmount = Math.floor((subtotal * couponDiscount) / 100);
  if (discountAmount > 0) {
    itemList.push({
      name: "Diskon Kupon",
      price: -discountAmount,
      quantity: 1
    });
  }

  const shippingFee = parseInt(shippingCost);
  if (shippingFee > 0) {
    itemList.push({
      name: "Ongkir",
      price: shippingFee,
      quantity: 1
    });
  }

  const finalAmount = itemList.reduce((total, item) => total + item.price * item.quantity, 0);
  if (isNaN(finalAmount) || finalAmount < 100) return alert("Total belanja terlalu kecil. Minimal Rp 100.");

  const payload = {
    name,
    email,
    phone,
    address,
    coupon: couponDiscount,
    shipping: shippingFee,
    items: itemList
  };

  try {
    const baseURL = location.hostname === "localhost" ? "http://localhost:4000" : "http://31.97.111.172:4000";

    const response = await fetch(`${baseURL}/create-transaction`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });

    const data = await response.json();

    if (response.ok && data.token && window.snap?.pay) {
      window.snap.pay(data.token, {
        onSuccess: () => {
          alert("Pembayaran berhasil!");
          localStorage.removeItem("cartItems");
          localStorage.removeItem("appliedCoupon");
          window.location.href = "index.html";
        },
        onPending: () => alert("Pembayaran tertunda."),
        onError: (result) => {
          alert("Terjadi kesalahan pembayaran.");
          console.error("Midtrans error:", result);
        },
        onClose: () => alert("Pembayaran dibatalkan.")
      });
    } else {
      alert("Gagal mendapatkan token pembayaran.");
      console.error("Respon:", data);
    }
  } catch (err) {
    console.error("Gagal checkout:", err);
    alert("Terjadi kesalahan saat checkout.");
  }
}

document.addEventListener("DOMContentLoaded", () => {
  swiperInstance = new Swiper(".myslider", {
    loop: true,
    pagination: {
      el: ".swiper-pagination",
      clickable: true,
    },
  });

  const citySelect = document.getElementById("city");
  if (citySelect) {
    citySelect.addEventListener("change", updateShippingByCity);
    if (citySelect.value) updateShippingByCity(); // trigger saat reload
  }

  const savedCoupon = localStorage.getItem("appliedCoupon");
  if (savedCoupon) {
    document.getElementById("coupon-code").value = savedCoupon;
    applyCoupon();
  } else {
    loadCart();
  }

  updateCartInfo();
});
</script>

</body>
</html>